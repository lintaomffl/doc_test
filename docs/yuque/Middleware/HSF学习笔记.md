# HSF学习笔记

一种RPC框架。
<a name="y8oxA"></a>
## 什么是RPC框架
**RPC**（Remote Procedure Call Protocol），远程过程调用协议，网络上的一台计算机可以通过该协议调用另外一台计算机上提供的服务或方法，它是进程间通信（IPC）的一种方式。通过该框架方式可利用本地调用的方式调用远程服务器的方法。<br />

<a name="LEs2p"></a>
## 为什么要有RPC
RPC 是SOA以及现在分布式系统的基石，分布式架构下，服务分布在不同的机器上，他们之间就需要某种方式来通信，RPC正是解决这个问题的，它承担了**分布式系统中服务间的通信重任。**<br />

<a name="J3lWf"></a>
## RPC框架需要解决的核心问题
从上面分析来看，一个RPC框架需要解决的核心问题如下：

- 服务暴露： 服务端如何将自身的能力告知客户端，目前较常用的方式是通过IDL（Interface Definition Language）来定义远程接口，客户端通过框架根据IDL生成Stub端代码
- 远程对象的代理：从客户端视角来看，它应该持有一个服务端的代理对象，通过该对象来调用到服务端服务。
- 通信：数据如何通信，根据上述分析可以有HTTP、TCP、UDP等途径，此外还要考虑如下问题：
   - 消息ID
   - 心跳
   - IO方式及连接数
- 序列化：数据如何转换为二进制格式供网络传输。 就序列化而言，Java 提供了默认的序列化方式，但在高并发的情况下，这种方式将会带来一些性能上的瓶颈，于是市面上出现了一系列优秀的序列化框架，比如Protobuf、Kryo、Hessian、Jackson 等，它们可以取代 Java 默认的序列化，从而提供更高效的性能

<br />
<a name="himpa"></a>
## 关于HSF：
阿里内部使用的RPC框架。<br />![image.png](https://intranetproxy.alipay.com/skylark/lark/0/2020/png/304852/1590664766446-38f32a70-461e-4789-9f60-583d2b5bef79.png#align=left&display=inline&height=304&margin=%5Bobject%20Object%5D&name=image.png&originHeight=373&originWidth=828&size=39009&status=done&style=none&width=674)<br />地址注册中心：服务提供方将所提供的服务进行注册，以便消费服务方对于对应的服务进行利用注册中心来订阅想要的服务；<br />元数据存储中心：来用存储各类服务所需要的对应参数；<br />HSF控制台：主要通过对于持久化配置中心与地址注册中心来为用户提供一系列的运维服务，综合控制管理HSF框架；<br />持久化配置中心：通过维护一系列规则来决定干预获取服务的路由选择；<br />路由规则：HSF 路由规则作用在 **服务的消费者**，在消费端调用服务前的选址阶段，对地址选择逻辑做干预，从而实现流量划分、读写分离等目标。<br />归组规则：HSF y归组规则作用在 **服务的提供者**，在 HSF 服务的发布期生效，将指定服务的组别修改为特定的值。这样，不同分组中的 HSF 服务实例就组成了以 group 为单位的集群，实现服务端集群的划分，从而仅针对部分客户端工作。<br />同机房规则：HSF 同机房规则作用在 **服务的消费者**，在消费端调用服务前的选址阶段，根据机房网段信息优先选择同一个机房的服务提供方发起调用，从而减少跨机房流量的产生。<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />

